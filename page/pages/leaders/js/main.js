const firebaseConfig={apiKey:"AIzaSyCOIQr3REsBR9gTfPNo37uDiruxsLibrM8",authDomain:"testcontent-d38c2.firebaseapp.com",databaseURL:"https://testcontent-d38c2-default-rtdb.firebaseio.com",projectId:"testcontent-d38c2",storageBucket:"testcontent-d38c2.appspot.com",messagingSenderId:"958227719442",appId:"1:958227719442:web:bb8bd9dd4e8fde1a817fcb"};var Data;firebase.initializeApp(firebaseConfig);var username=localStorage.getItem("ss47_webtest_user_i"),_u_n_=localStorage.getItem("ss47_webtest_user_n");function JsonToList(t){var e=t,r=[];for(var n in e)r.push([n,e[n]]);return r}function ArrWithLen(t){for(var e=parseInt(t),r=[],n=0;n<e;n++)r.push(0);return r}function Index(t,e){for(var r=0;r<t.length;r++)if(t[r]==e)return r;return-1}function _Str(t){var e="";return e+=t}function UpdateLeaders(){for(var t=[],e=[],r=JsonToList(Data.users),n=0;n<r.length;n++)t.push(r[n][1].nick),e.push(r[n][0]);for(var s=ArrWithLen(t.length),a=0;a<r.length;a++){var o=JsonToList(r[a][1]);for(n=0;n<o.length;n++)if("nick"!=o[n][0]&&"cancreatetests"!=o[n][0]&&"questionnum"!=o[n][0])if(null==o[n][1].results);else for(var i=JsonToList(o[n][1].results),c=0;c<i.length;c++){var u=i[c][0],l=parseInt(i[c][1].maxscore);s[Index(t,Data.users[u].nick)]+=l}}for(n=0;n<t.length;n++)for(c=n+1;c<t.length;c++)if(s[n]<s[c]){var d=_Str(t[n]);t[n]=_Str(t[c]),t[c]=_Str(d);var _=parseInt(s[n]);s[n]=parseInt(s[c]),s[c]=parseInt(_);var f=_Str(e[n]);e[n]=_Str(e[c]),e[c]=_Str(f)}var b="";for(n=0;n<t.length;n++)b+='<tr>\n\t\t<th scope="row">'+(n+1)+'</th>\n\t\t<td><button class="btn btn-dark" onclick="AboutFriend(\''+e[n]+"')\">"+t[n]+"</button></td>\n\t\t<td>"+s[n]+"</td>\n\t\t<tr>";document.getElementById("id_list_leaders").innerHTML=b}async function CheckUser(){await firebase.database().ref().get().then(t=>{t.exists()?(Data=t.val(),UpdateLeaders()):console.log("Server Error!")}).catch(t=>{alert("No Connection!"),console.error(t)})}function AboutFriend(t){localStorage.setItem("ss47_webtest_user_i",username),localStorage.setItem("ss47_webtest_user_n",_u_n_),localStorage.setItem("ss47_webtest_friend_i",t),window.location="../friend/friend.html"}CheckUser(),document.getElementById("id_btn_back").onclick=function(){localStorage.setItem("ss47_webtest_user_i",username),localStorage.setItem("ss47_webtest_user_n",_u_n_),window.location="../../main.html"};
